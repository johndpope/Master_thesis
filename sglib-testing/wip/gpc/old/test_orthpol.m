function test_orthpol
% TEST_ORTHPOL Test the ORTHPOL functions.

assert_set_function( 'orthpol' );

% Define test cases; generated by Mathematica (see orthpol.nb)
legendre_p=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 1, 0; 0, 0, 0, 3/2, 0, -1/2; 0, 0, ...
    5/2, 0, -3/2, 0; 0, 35/8, 0, -15/4, 0, 3/8; 63/8, 0, -35/4, 0, 15/8, 0];
chebyshev_t=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 1, 0; 0, 0, 0, 2, 0, -1; 0, 0, 4, ...
    0, -3, 0; 0, 8, 0, -8, 0, 1; 16, 0, -20, 0, 5, 0];
chebyshev_u=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 2, 0; 0, 0, 0, 4, 0, -1; 0, 0, 8, ...
    0, -4, 0; 0, 16, 0, -12, 0, 1; 32, 0, -32, 0, 6, 0];
jacobi_p_a0_b0=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 1, 0; 0, 0, 0, 3/2, 0, -1/2; 0, ...
    0, 5/2, 0, -3/2, 0; 0, 35/8, 0, -15/4, 0, 3/8; 63/8, 0, -35/4, 0, 15/8, 0];
jacobi_p_a1_b1=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 2, 0; 0, 0, 0, 15/4, 0, -3/4; ...
    0, 0, 7, 0, -3, 0; 0, 105/8, 0, -35/4, 0, 5/8; 99/4, 0, -45/2, 0, 15/4, 0];
jacobi_p_a1_b0=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 3/2, 1/2; 0, 0, 0, 5/2, 1, ...
    -1/2; 0, 0, 35/8, 15/8, -15/8, -3/8; 0, 63/8, 7/2, -21/4, -3/2, 3/8; 231/16, ...
    105/16, -105/8, -35/8, 35/16, 5/16];
jacobi_p_a0_b1=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 3/2, -1/2; 0, 0, 0, 5/2, -1, ...
    -1/2; 0, 0, 35/8, -15/8, -15/8, 3/8; 0, 63/8, -7/2, -21/4, 3/2, 3/8; 231/16, ...
    -105/16, -105/8, 35/8, 35/16, -5/16];
jacobi_p_a0_b1_2=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 5/4, -1/4; 0, 0, 0, 63/32, ...
    -7/16, -17/32; 0, 0, 429/128, -99/128, -225/128, 23/128; 0, 12155/2048, ...
    -715/512, -4719/1024, 341/512, 827/2048; 88179/8192, -20995/8192, ...
    -45305/4096, 7605/4096, 17615/8192, -1207/8192];
jacobi_p_a1_b2=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 5/2, -1/2; 0, 0, 0, 21/4, -3/2, ...
    -3/4; 0, 0, 21/2, -7/2, -7/2, 1/2; 0, 165/8, -15/2, -45/4, 5/2, 5/8; 1287/32, ...
    -495/32, -495/16, 135/16, 135/32, -15/32];
jacobi_p_a2_b2=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 3, 0; 0, 0, 0, 7, 0, -1; 0, 0, ...
    15, 0, -5, 0; 0, 495/16, 0, -135/8, 0, 15/16; 1001/16, 0, -385/8, 0, 105/16, ...
    0];
gegenbauer_c_l1=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 2, 0; 0, 0, 0, 4, 0, -1; 0, 0, ...
    8, 0, -4, 0; 0, 16, 0, -12, 0, 1; 32, 0, -32, 0, 6, 0];
gegenbauer_c_l0=[0, 0, 0, 0, 0, 0; 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, 0, 0; 0, 0, ...
    0, 0, 0, 0; 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, 0, 0];
gegenbauer_c_l2=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 4, 0; 0, 0, 0, 12, 0, -2; 0, ...
    0, 32, 0, -12, 0; 0, 80, 0, -48, 0, 3; 192, 0, -160, 0, 24, 0];
gegenbauer_c_l3=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 6, 0; 0, 0, 0, 24, 0, -3; 0, ...
    0, 80, 0, -24, 0; 0, 240, 0, -120, 0, 6; 672, 0, -480, 0, 60, 0];
gegenbauer_c_l1_2=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 1, 0; 0, 0, 0, 3/2, 0, -1/2; ...
    0, 0, 5/2, 0, -3/2, 0; 0, 35/8, 0, -15/4, 0, 3/8; 63/8, 0, -35/4, 0, 15/8, ...
    0];
laguerre_l=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, -1, 1; 0, 0, 0, 1/2, -2, 1; 0, 0, ...
    -1/6, 3/2, -3, 1; 0, 1/24, -2/3, 3, -4, 1; -1/120, 5/24, -5/3, 5, -5, 1];
laguerre_l_a0=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, -1, 1; 0, 0, 0, 1/2, -2, 1; 0, ...
    0, -1/6, 3/2, -3, 1; 0, 1/24, -2/3, 3, -4, 1; -1/120, 5/24, -5/3, 5, -5, 1];
laguerre_l_a1_2=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, -1, 3/2; 0, 0, 0, 1/2, -5/2, ...
    15/8; 0, 0, -1/6, 7/4, -35/8, 35/16; 0, 1/24, -3/4, 63/16, -105/16, 315/128; ...
    -1/120, 11/48, -33/16, 231/32, -1155/128, 693/256];
laguerre_l_a1=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, -1, 2; 0, 0, 0, 1/2, -3, 3; 0, ...
    0, -1/6, 2, -6, 4; 0, 1/24, -5/6, 5, -10, 5; -1/120, 1/4, -5/2, 10, -15, 6];
laguerre_l_a2=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, -1, 3; 0, 0, 0, 1/2, -4, 6; 0, ...
    0, -1/6, 5/2, -10, 10; 0, 1/24, -1, 15/2, -20, 15; -1/120, 7/24, -7/2, 35/2, ...
    -35, 21];
hermite_h=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 2, 0; 0, 0, 0, 4, 0, -2; 0, 0, 8, 0, ...
    -12, 0; 0, 16, 0, -48, 0, 12; 32, 0, -160, 0, 120, 0];
hermite_s=[0, 0, 0, 0, 0, 1; 0, 0, 0, 0, 1, 0; 0, 0, 0, 1, 0, -1; 0, 0, 1, 0, ...
    -3, 0; 0, 1, 0, -6, 0, 3; 1, 0, -10, 0, 15, 0];


assert_equals( orthpol( 'legendre', 5 ), legendre_p, 'legendre' );
assert_equals( orthpol( 'chebyshev', 5, 'T' ), chebyshev_t, 'chebyshev_t' );
assert_equals( orthpol( 'chebyshev', 5, 'U' ), chebyshev_u, 'chebyshev_u' );
assert_equals( orthpol( 'jacobi', 5, '', [0,0] ), jacobi_p_a0_b0, 'jacobi_p_a0_b0' );
assert_equals( orthpol( 'jacobi', 5, '', [1,1] ), jacobi_p_a1_b1, 'jacobi_p_a1_b1' );
assert_equals( orthpol( 'jacobi', 5, '', [0,1] ), jacobi_p_a0_b1, 'jacobi_p_a0_b1' );
assert_equals( orthpol( 'jacobi', 5, '', [1,0] ), jacobi_p_a1_b0, 'jacobi_p_a1_b0' );
assert_equals( orthpol( 'jacobi', 5, '', [0,1/2] ), jacobi_p_a0_b1_2, 'jacobi_p_a0_b1_2' );
assert_equals( orthpol( 'jacobi', 5, '', [1,2] ), jacobi_p_a1_b2, 'jacobi_p_a1_b2' );
assert_equals( orthpol( 'jacobi', 5, '', [2,2] ), jacobi_p_a2_b2, 'jacobi_p_a2_b2' );
assert_equals( orthpol( 'gegenbauer', 5, '', [1] ), gegenbauer_c_l1, 'gegenbauer_c_l1' );
%gegenbauer_c_l0(1,end)=1; % problematic definition here
%assert_equals( orthpol( 'gegenbauer', 5, '', [0] ), gegenbauer_c_l0, 'gegenbauer_c_l0' );
assert_equals( orthpol( 'gegenbauer', 5, '', [2] ), gegenbauer_c_l2, 'gegenbauer_c_l2' );
assert_equals( orthpol( 'gegenbauer', 5, '', [3] ), gegenbauer_c_l3, 'gegenbauer_c_l3' );
assert_equals( orthpol( 'gegenbauer', 5, '', [1/2] ), gegenbauer_c_l1_2, 'gegenbauer_c_l1_2' );

assert_equals( orthpol( 'laguerre', 5, '', [] ), laguerre_l, 'laguerre_l' );
assert_equals( orthpol( 'laguerre', 5, '', [0] ), laguerre_l_a0, 'laguerre_l_a0' );
assert_equals( orthpol( 'laguerre', 5, '', [1/2] ), laguerre_l_a1_2, 'laguerre_l_a1_2' );
assert_equals( orthpol( 'laguerre', 5, '', [1] ), laguerre_l_a1, 'laguerre_l_a1' );
assert_equals( orthpol( 'laguerre', 5, '', [2] ), laguerre_l_a2, 'laguerre_l_a2' );

assert_equals( orthpol( 'hermite', 5, 'physicist' ), hermite_h, 'hermite_h' );
assert_equals( orthpol( 'hermite', 5, 'stochasticist' ), hermite_s, 'hermite_s' );

